{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 6b03848cbf72d34a6ff9","webpack:///./src/config/config.js","webpack:///./src/index.js","webpack:///./src/origin_id.js","webpack:///external \"cryptr\"","webpack:///./src/letters.js","webpack:///./src/qr-code.js","webpack:///./src/systemConfig.js","webpack:///./src/config/systemConfigDefaults.js"],"names":["config","user_key_phone_code","user_key_other_code","user_key_code_length","user_key_secret","available_characters_proposals","available_letters_primary","available_letters_map","qr_code_prefix","OriginId","AvailableLetters","QrCode","systemConfigDefaults","systemConfigInitial","encryptor","min_length","DeviceIdException","s","message","name","generateFromString","code","encrypted","encrypt","generateFromDeviceId","length","verify","origin_id","dec","decryptRaw","err","splitParts","getOrigin","origin","getOriginType","decrypted","decrypt","substr","proposal","primary","map","prefix","MakeValuesObject","defaults","obj","Object","keys","forEach","key","defaultValue","proposals_auto_accept","title","proposal_boost_amount","track_player_movements","tinder_proposals_regeneration_interval","trending_regeneration_interval","trend_damping_halflife_time","map_update_interval","map_update_latency","map_cache_update_interval","map_query_update_latency","map_letter_decay_time","map_letter_regeneration_time_primary","map_letter_regeneration_time_secondary","map_letter_transfer_timeout","map_drop_zone_radius","map_min_zoom_level","map_max_zoom_level","map_letter_base_size","map_delta_initial","map_delta_max","map_max_markers","map_primary_letter_reset","stream_twitter_handle","challenge_list_image_url"],"mappings":"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","file":"maree-lettres-shared.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"cryptr\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"maree-lettres-shared\", [\"cryptr\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"maree-lettres-shared\"] = factory(require(\"cryptr\"));\n\telse\n\t\troot[\"maree-lettres-shared\"] = factory(root[\"cryptr\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 6b03848cbf72d34a6ff9","const config = {\n  user_key_phone_code: 'oAmQRC', // random key to mark a string as a valid origin id from phone\n  user_key_other_code: 'zsl25y', // random key to mark a string as a valid origin id from string\n  user_key_code_length: 6, // length of the codes above\n  user_key_secret: 'kYB1rIzSjbEhKEMAFCvx', // random key used for encryption between server and client\n  available_characters_proposals: 'AAABCDEEEEFGHIIJKLLMNNOOPPQQRRSSSTTUUVWXYZ?*:', // all the physical letters\n  available_letters_primary: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', // letter vailable for personal choice\n  available_letters_map: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', // letters allowed on map\n  qr_code_prefix: 'http://lettres.paris/'\n};\n\nexport default config;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/config.js","import { OriginId } from './origin_id.js';\nimport { AvailableLetters } from './letters.js';\nimport { QrCode } from './qr-code.js';\nimport { systemConfigDefaults, systemConfigInitial } from './systemConfig.js';\n\nexport { OriginId, AvailableLetters, QrCode, systemConfigDefaults, systemConfigInitial };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/*\n* usage:\n* import shared from 'maree-lettres-shared';\n* console.log(shared.userKeys.getBrowserUserKey());\n*/\nimport Cryptr from 'cryptr';\n\nimport config from './config/config.js';\n\nconst encryptor = new Cryptr(config.user_key_secret);\nconst min_length = 8;\n\nfunction DeviceIdException(s) {\n  this.message = `Invalid DeviceId \"${s}\" – minimum ${min_length} characters required.`;\n  this.name = 'DeviceIdException';\n}\n\nconst OriginId = {\n  // user functions\n\n  generateFromString(s) {\n    const code = s + '-' + config.user_key_other_code;\n    const encrypted = encryptor.encrypt(code);\n\n    return encrypted;\n  },\n\n  generateFromDeviceId(s) {\n    if (typeof s !== 'string' || s === '' || s.length < min_length) {\n      throw new DeviceIdException(s);\n    }\n\n    const code = s + '-' + config.user_key_phone_code;\n    const encrypted = encryptor.encrypt(code);\n\n    return encrypted;\n  },\n\n  verify(origin_id) {\n    let dec = '';\n\n    try {\n      dec = this.decryptRaw(origin_id);\n    } catch (err) {\n      return false;\n    }\n\n    const code = this.splitParts(dec).code;\n\n    return code === config.user_key_phone_code || code === config.user_key_other_code;\n  },\n\n  getOrigin(origin_id) {\n    const dec = this.decryptRaw(origin_id);\n    const origin = this.splitParts(dec).origin;\n\n    return origin;\n  },\n\n  getOriginType(origin_id) {\n    const dec = this.decryptRaw(origin_id);\n    const code = this.splitParts(dec).code;\n\n    if (code === config.user_key_phone_code) {\n      return 'phone';\n    } else if (code === config.user_key_other_code) {\n      return 'other';\n    }\n    return 'unknown';\n  },\n\n  // private\n\n  decryptRaw(origin_id) {\n    const decrypted = encryptor.decrypt(origin_id);\n\n    return decrypted;\n  },\n\n  splitParts(decrypted) {\n    return {\n      code: decrypted.substr(-1 * config.user_key_code_length),\n      origin: decrypted.substr(0, decrypted.length - config.user_key_code_length - 1)\n    };\n  }\n};\n\nexport { OriginId, DeviceIdException };\n\n\n\n// WEBPACK FOOTER //\n// ./src/origin_id.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cryptr\"\n// module id = 3\n// module chunks = 0","import config from './config/config';\n\nconst AvailableLetters = {};\n\nAvailableLetters.proposal = config.available_characters_proposals;\nAvailableLetters.primary = config.available_letters_primary;\nAvailableLetters.map = config.available_letters_map;\n\nexport { AvailableLetters };\n\n\n\n// WEBPACK FOOTER //\n// ./src/letters.js","import config from './config/config.js';\n\nconst QrCode = {\n    prefix: config.qr_code_prefix\n};\n\nexport { QrCode };\n\n\n\n// WEBPACK FOOTER //\n// ./src/qr-code.js","import systemConfigDefaults from './config/systemConfigDefaults.js';\n\nconst MakeValuesObject = function (defaults) {\n    let obj = {};\n\n    Object.keys(defaults).forEach((key) => {\n        if (typeof defaults[key] === 'function') return;\n        obj[key] = defaults[key].defaultValue;\n    });\n    return obj;\n};\n\nconst systemConfigInitial = MakeValuesObject(systemConfigDefaults);\n\nexport default { systemConfigDefaults, systemConfigInitial };\n\n\n\n// WEBPACK FOOTER //\n// ./src/systemConfig.js","const systemConfigDefaults = {\n    proposals_auto_accept: {\n        defaultValue: false,\n        title: 'Auto-Accept new proposals, bypass review process'\n    },\n    proposal_boost_amount: {\n        defaultValue: 5,\n        title: 'The boost in number of positive votes a proposal gets when a proposal with the same text is submitted'\n    },\n    track_player_movements: {\n        defaultValue: true,\n        title: 'Constantly update player positions on map'\n    },\n    tinder_proposals_regeneration_interval: {\n        defaultValue: 300,\n        title: 'Interval at which TinderProposals get regenerated on Server (seconds)'\n    },\n    trending_regeneration_interval: {\n        defaultValue: 60,\n        title: 'Interval at which Trends get calculated on Server (seconds)'\n    },\n    trend_damping_halflife_time: {\n        defaultValue: 120,\n        title: 'Damping of trend changes: time in seconds after which half of the impact of a change will be gone'\n    },\n    map_update_interval: {\n        defaultValue: 10,\n        title: 'Map: Update interval when map screen is open'\n    },\n    map_update_latency: {\n        defaultValue: 2,\n        title: 'Map Server: Extra time to compensate network latency'\n    },\n    map_cache_update_interval: {\n        defaultValue: 10,\n        title: 'Map Server: How often te refresh the map letters cache (<= map_update_interval)'\n    },\n    map_query_update_latency: {\n        defaultValue: 1,\n        title: 'Map Server: How long it takes to query the database'\n    },\n    map_letter_decay_time: {\n        defaultValue: 5000,\n        title: 'Map: Letter Decay Time (seconds)'\n    },\n    map_letter_regeneration_time_primary: {\n        defaultValue: 5,\n        title: 'Map: Regeneration time of Primary Letter (seconds)'\n    },\n    map_letter_regeneration_time_secondary: {\n        defaultValue: 5,\n        title: 'Map: Regeneration time of Secondary Letters (seconds)'\n    },\n    map_letter_transfer_timeout: {\n        defaultValue: 60,\n        title: 'Map: For how long a letter share QR code is valid'\n    },\n    map_drop_zone_radius: {\n        defaultValue: 75,\n        title: 'Map: Radius of the drop zone in meters'\n    },\n    map_min_zoom_level: {\n        defaultValue: 0,\n        title: 'Map: Minimum Zoom Level (NOTE: this is not used to set initial zoom, use map_delta_initial)'\n    },\n    map_max_zoom_level: {\n        defaultValue: 20,\n        title: 'Map: Maximum Zoom Level'\n    },\n    map_letter_base_size: {\n        defaultValue: 10,\n        title: 'Map: Letter size in meters'\n    },\n    map_delta_initial: {\n        defaultValue: 2.5,\n        title: 'Map: map zoom relative to dropzone size, 1 = drop zone is fullscreen'\n    },\n    map_delta_max: {\n        defaultValue: 9,\n        title: 'Map: maximum map zoom relative to drop zone size'\n    },\n    map_max_markers: {\n        defaultValue: 50,\n        title: 'Map: maximum number of letters to render as markers on map'\n    },\n    map_primary_letter_reset: {\n        defaultValue: 1440,\n        title: 'Map: time after which primary letter can be reset (in minutes)'\n    },\n    stream_twitter_handle: {\n        defaultValue: 'http://sebquack.perseus.uberspace.de/maree/TwitterWebView.html',\n        title: 'Stream: The twitter handle'\n    },\n    challenge_list_image_url: {\n        defaultValue: 'http://sebquack.perseus.uberspace.de/maree/title.jpg',\n        title: 'Image for topic list'\n    }\n};\n\nexport default systemConfigDefaults;\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/systemConfigDefaults.js"],"sourceRoot":""}